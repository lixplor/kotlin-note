# Kotlin

* Kotlin是IntelliJ开发的一种基于JVM的弱类型语言
* 编码风格
    - 语句结尾不用`;`
    - 命名风格
        - 使用驼峰命名
        - 类名首字母大写
        - 方法和属性首字母小写
        - 缩进用4个空格
        - public方法要写说明文档
    - Unit
        - 如果函数返回Unit, 则可以省略返回值类型
    - 冒号
        - `:`冒号在区分类型和父类型时, 中间要有空格; 在示例和类型之间没有空格
        - 示例
            - `interface Foo<out T : Any> : Bar {}`
            - `fun foo(a: Int): T`
    - Lambda表达式
        - Lambda表达式中, 大括号与表达式间要有空格, 箭头与参数和函数体之间要有空格
        - 示例: `list.filter { it > 10 }.map { element -> element * 2 }`
    - 类声明格式
        - 单行声明方式
        - 多行声明方式
            - 具有较多参数的类应该格式化成每个构造函数的参数都位于缩进的单独的行中
            - 结束括号应该在新的一行
            - 如果使用继承, 那么父类构造函数调用或实现的接口列表应该位于与括号相同的行中
    - 函数和属性
        - 某些情况下, 没有参数的函数可以与只读属性互换

```kotlin
// 单行声明方式
class Person(id: Int, name: String)

// 多行声明方式
class Person(
    id: Int,
    name: String,
): Human(id, name) {
    // ...
}
```



## 基本语法

### 注释

```kotlin
// 单行注释

/*
多行
注释
*/
```

### 基本类型

* Kotlin中, 所有东西都是对象. 可以调用任何变量的成员函数和属性.
* 数值类型
    - Double: 64位
    - Float: 32位
    - Long: 64位
    - Int: 32位
    - Short: 16位
    - Byte: 8位
    - 注意:
        - 字符在Kotlin中不是数值类型
        - Kotlin中数值不存在隐式转换
    - 显式转换
        - 由于没有隐式转换, 不同数值类型之间不能自动转换, 需要显式调用方法. 但注意, Kotlin中仍然可以自推导出数值的类型, 但适用于变量并未指定类型的场景
        - 每种数值类型都支持以下转换方法
            - `toByte(): Byte`
            - `toShort(): Short`
            - `toInt(): Int`
            - `toLong(): Long`
            - `toFloat(): Float`
            - `toDouble(): Double`
            - `toChar(): Char`
* 字符类型
    - Char: 字符. 使用单引号包裹, `'1'`
        - 注意, 不能直接当数值来用
* 布尔类型
    - boolean
* 数组
    - 用`Array`类表示, 有`get`和`set`方法或`[]`, 及`size`属性
    - 创建数组:
        - 使用库函数`arrayOf()`: `val arr = arrayOf(1, 2, 3)`
        - 使用工厂函数: `val arr = Array(1, 2, 3)`
* 字符串
    - `String`: 字符串是不可变的.
        - 字符串的每个字符可以通过索引读取: `str[0]`
        - 字符串也可以通过for循环迭代出字符: `for (c in str) { println(c) }`
* 字面值常量
    - 十进制数值: `123`
    - 长整型要加大写L: `123L`
    - 十六进制: `0x0f`
    - 二进制: `0b00000101`
    - 双精度浮点数: `123.5`
    - 单精度浮点数: `123.5F`
    - 注意:
        - 不支持八进制
        - 1.1版本开始, 数值常量中可以添加`_`下划线分隔
            - `1_000_000`
            - `0xFF_1E`
            - `0b0000_1010`
    - 字符串字面值
        - 可以带转义符的: `Hello world!\n`
        - 可以包含换行的: `""" for (c in "foo") { } """`
            - 这种形式不能包含转义字符
            - 可以通过`.trimMargin()`移除空格



### 定义变量

* 局部变量

```kotlin
// 格式1
val 变量名: 类型 = 初始化值

// 示例
val a: Int

// 格式2
val b = 2   // 自推到出数据类型

// 格式3
val c: Int  // 没有初始化值
c = 4       // 赋值
```

### 包定义

* 使用`pakcage`关键字
* 在源代码文件开头定义包
* 包名不必和文件夹路径一致, 源代码文件可以放在任意位置

```kotlin
package com.kotlin
```

### 函数定义

* 使用`fun`关键字

```kotlin
// 格式
fun 函数名(参数名: 参数类型, 参数名: 参数类型): 返回值类型 {
    函数体
}

// 示例
fun sum(a: Int, b: Int): Int {
    return a + b
}
```

* 当只有一个表达式作为函数体时, 可以按如下方式定义函数

```kotlin
fun sum(a: Int, b: Int) = a + b
```

* 没有返回值时, 返回值类型使用`Unit`或省略返回值类型

```kotlin
// 使用Unit
fun printSum(a: Int, b: Int): Unit {
    println("sum of $a and $b is ${a + b}")
}

// 省略返回值类型
fun printSum(a: Int, b: Int) {
    println("sum of $a and $b is ${a + b}")
}
```

### 字符串模板

* 字符串模板可以在字符串中使用模板表达式, 将变量的值引入字符串中
* 字符串模板格式:
    - `$变量名`: 使用变量的值
    - `${表达式}`: 使用表达式获取值
* 字符串模板既可以在原始字符串中使用, 也可以在转义字符串中使用

```kotlin
val i = 10
val s = "i = $i"  // 即 i = 10

val s = "abc"
val str = "$s.length is ${s.length}"  // 即 abc.length is 3
```

### 条件表达式

```kotlin
fun maxOf(a: Int, b: Int): Int {
    if (a > b) {
        return a
    } else {
        return b
    }
}

// 使用if作为表达式
fun maxOf(a: Int, b: Int) = if (a > b) a else b
```


### 可空变量, 空值检查

* 当空值可能出现时, 应该明确指出该引用可空

```kotlin
//
fun parseInt(str: String): Int? {
    //...
}
```
